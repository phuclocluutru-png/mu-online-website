<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=1200, initial-scale=1.0, user-scalable=no" />
    <title>Bài viết - MU PKClear</title>
    <link rel="icon" href="../images/Logo PK CLEAR -.png" type="image/png">
    <link rel="stylesheet" href="../css/base.css" />
    <link rel="stylesheet" href="../css/components/post.css" />
    <link rel="stylesheet" href="../css/components/hero.css" />
    <link rel="stylesheet" href="../css/components/header.css" />
    <link rel="stylesheet" href="../css/components/footer.css" />
    <link rel="stylesheet" href="../css/components/modal-download.css" />
    <!-- Open Graph & Twitter static fallbacks -->
    <meta property="og:site_name" content="MU PKClear" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Bài viết - MU PKClear" />
    <meta property="og:description" content="Cộng đồng MU Online PK Clear - Tin tức, hướng dẫn và sự kiện." />
    <meta property="og:url" content="https://pkclear.com/pages/post.html" />
    <meta property="og:image" content="https://pkclear.com/images/Logo%20PK%20CLEAR%20-.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Bài viết - MU PKClear" />
    <meta name="twitter:description" content="Cộng đồng MU Online PK Clear - Tin tức, hướng dẫn và sự kiện." />
    <meta name="twitter:image" content="https://pkclear.com/images/Logo%20PK%20CLEAR%20-.png" />
    <link rel="canonical" href="https://pkclear.com/pages/post.html" />
    <script>
        // Client-side dynamic OG meta (note: most social crawlers do NOT execute JS; server-side rendering recommended)
        (function () {
            const params = new URLSearchParams(location.search);
            const id = params.get('id');
            if (!id) return;
            const apiBase = 'https://mu.pkclear.com/wp-json/wp/v2'; // Adjust if different domain
            fetch(`${apiBase}/posts/${id}?_embed`).then(r => r.json()).then(post => {
                if (!post || !post.title) return;
                const strip = html => (html || '').replace(/<[^>]+>/g, '');
                const title = strip(post.title.rendered);
                const desc = strip(post.excerpt?.rendered).slice(0, 160).trim();
                const media = post._embedded?.['wp:featuredmedia']?.[0]?.source_url;
                const image = media || 'https://pkclear.com/images/Logo%20PK%20CLEAR%20-.png';
                const url = location.href.split('#')[0];
                const ensureProp = (p, v) => { let el = document.querySelector(`meta[property='${p}']`); if (!el) { el = document.createElement('meta'); el.setAttribute('property', p); document.head.appendChild(el); } el.setAttribute('content', v); };
                const ensureName = (n, v) => { let el = document.querySelector(`meta[name='${n}']`); if (!el) { el = document.createElement('meta'); el.setAttribute('name', n); document.head.appendChild(el); } el.setAttribute('content', v); };
                ensureProp('og:title', title);
                ensureProp('og:description', desc || 'Bài viết MU PKClear');
                ensureProp('og:url', url);
                ensureProp('og:image', image);
                ensureName('twitter:title', title);
                ensureName('twitter:description', desc || 'Bài viết MU PKClear');
                ensureName('twitter:image', image);
                document.title = `${title} | MU PKClear`;
            }).catch(() => { });
        })();
    </script>
</head>

<body>
    <div data-include="layout/header"></div>
    <div data-include="sections/hero"></div>
    <main class="postView" id="post-view" data-loading="true">
        <div class="container postView__container">
            <div class="postView__grid">
                <aside class="postView__sidebar" id="post-sidebar" aria-label="Danh mục">
                    <div class="postView__cats" id="post-cats">
                        <div class="postView__loading">Đang tải danh mục...</div>
                    </div>
                </aside>
                <article class="postView__article" id="post-article" aria-live="polite">
                    <div class="postView__loading">Đang tải bài viết...</div>
                </article>
            </div>
        </div>
    </main>
    <div data-include="layout/footer"></div>

    <!-- Download Modal -->
    <div data-include="modal-download"></div>

    <script src="../js/includes.js" defer></script>
    <script src="../js/modal-download.js"></script>
    <script type="module" src="../js/main.js"></script>
    <script type="module" src="../js/post.js"></script>
